##Azure login
Een login voor Azure is enkel mogelijk met het powershell commando **Add-AzureAccount**. Mijn plan was om op de WebApp de user zich te laten inloggen en achterliggend zijn username en paswoord mee te geven als parameter.  
Dit is mogelijk via de **-credential** parameter. Dit had een mooie en simpele oplossing geweest maar microsoft denkt daar anders over. Via deze parameter kunnen enkel organisational accounts inloggen, microsoft accounts zijn niet ondersteund. Het is mogelijk dat in volgende versies van de Azure cmdlets dit wel ondersteund wordt. Maar op dit moment kunnen we dit niet gebruiken.  
  
We gebruiken dus het commando **Add-AzureAccount** om in te loggen, dit zal een pop up scherm geven waarop de user zich aanmeldt. Dit geeft ook weer een ongewilt probleem mee dat het pop up scherm enkel op de server waar de webApp draait tevoorschijn gaat komen en niet bij de user. Omdat er voorlopig geen andere oplossing is gaan we de gebruiker via remote desktop laten connecteren naar de server.  
Dit loginscript gaat ook nog een popup scherm tonen waarin de user zijn subscription aanduidt, dit gebeurd met het commando **Get-AzureSubscription|out-gridview -Title "Select Azure subscription" -passthru|select-azuresubscription**. Nadien gaan we de Virtual Machines van de geselecteerde subscription halen, dit moeten we twee maal doen, één keer voor de Azure Service Management en één keer voor de Azure Resource Manager. 
**Get-AzureVM -ErrorAction stop | ConvertTo-Json -Depth 999 | Out-File "$($path)jsonvmFileClassic.json"** zorgt ervoor dat alle Klassieke VMs in een JSON bestand worden gestoken. Voor de Resource manager VMs moeten we switchen van mode in de Powershell sessie, dit doen we aan de hand van **Switch-AzureMode AzureResourceManager**. Nu zitten we in de Resource manager en kunnen we deze VMs ophalen **AzureResourceManager\Get-AzureVM | ConvertTo-Json -Depth 999 | Out-File "$($path)jsonvmFile.json"**. 
De variabele **$path** geven we in de HomeController van de WebApp mee aan het script, deze is normaal in de map App_Data.  
  
Het is mogelijk dat een klant enkel maar Klassieke of Resource manager VMs in zijn subscription heeft, daarom steken we de Get-AzureVM commando's afzonderlijk in een try catch.